<%
	var passMunu = function(code){
		return ~session.menuCodeList.indexOf(code);
	}

	var removeMenu = function(arr){
		for(var i=0; i<arr.length;){
			var menu = arr[i];
			if(menu.code){
				if(!passMunu(menu.code)){
					arr.splice(i,1);
					continue;
				}
			}
			if(menu.child){
				removeMenu(menu.child);
			};
			i++;
		}
	}
%>
<script type="text/javascript">
	try{ace.settings.check('main-container' , 'fixed')}catch(e){}
</script>
<%
	var url = req.url,
		menus = [{
			name:'商户信息管理',
			code:'shxxgl',
			child: [{
				name: '商户信息',
				code:'shxxgl-shxx',
				url: '/merchant-info'
			}]
		},{
			name:'商户审核管理',
			code:'shshgl',
			child: [{
				name: '商户信息',
				code: 'shshgl-shxx',
				url: '/merchant-check'
			}]
		},{
			name:'支付渠道管理',
			code: 'zfqdgl',
			child: [{
				name: '支付渠道',
				code: 'zfqdgl-zfqd',
				url: '/payment-channel'
			}]
		},{
			name:'订单查询',
			code: 'ddgl',
			child: [{
				name: '订单',
				code: 'ddgl-dd',
				url: '/order'
			}]
		},{
			name:'文档管理',
			code: 'wdgl',
			child: [{
				name: '文档管理',
				code: 'wdgl-wdgl',
				url: '/documet'
			}]
		},{
			name:'支付节点统计',
			code: 'zfjd',
			child: [{
				name: '支付节点统计',
				code: 'zfjd-zfjd',
				url: '/payment-statistics'
			}]
		},{
			name: '常用功能',
			child: [{
				name: '修改密码',
				url: '/system/password'
			},{
				name: '安全退出',
				url: '/logout'
			}]
		}], mm;
	removeMenu(menus);
	for(var i=0;i<menus.length;i++){
		mm = menus[i];
		mm.keys = mm.child.map(function(v){return v.url});
	}
%>
<div id="sidebar" class="sidebar responsive">
	<script type="text/javascript">
		try{ace.settings.check('sidebar' , 'fixed')}catch(e){}
	</script>

	<ul class="nav nav-list">
		<%
			var menu, children, child;
			for(var i=0;i<menus.length;i++){
				menu = menus[i];
				children = menu.child;
		%>
		<li<%if(menu.keys.map(function(v){if(url.indexOf(v) > -1){return 1} return ''}).join('') != ''){%> class="active open"<%}%>>
			<a href="javascript:;" class="dropdown-toggle">
				<i class="menu-icon fa fa-desktop"></i>
				<span class="menu-text"> <%=menu.name%> </span>
				<b class="arrow fa fa-angle-down"></b>
			</a>
			<b class="arrow"></b>
			<ul class="submenu">
				<%
					for(var j=0;j<children.length;j++){
						child = children[j];
				%>
				<li<%if(url.indexOf(child.url)>-1){%> class="active"<%}%>>
					<a id="business-detail-query" href="<%-setting.proxyPath%><%=child.url%>">
						<i class="menu-icon fa fa-caret-right"></i>
						<%=child.name%>
					</a>
					<b class="arrow"></b>
				</li>
				<%}%>
			</ul>
		</li>
		<%}%>
	</ul><!-- /.nav-list -->

	<div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
		<i class="ace-icon fa fa-angle-double-left" data-icon1="ace-icon fa fa-angle-double-left" data-icon2="ace-icon fa fa-angle-double-right"></i>
	</div>

	<script type="text/javascript">
		try{ace.settings.check('sidebar' , 'collapsed')}catch(e){}
	</script>
</div>